{"id":"node_modules/react-useportal/dist/usePortal.js","dependencies":[{"name":"/Users/rheinze/Code/uikitten-popover-repro/node_modules/react-useportal/dist/usePortal.js.map","includedInParent":true,"mtime":1606848740637},{"name":"/Users/rheinze/Code/uikitten-popover-repro/package.json","includedInParent":true,"mtime":1609961906808},{"name":"/Users/rheinze/Code/uikitten-popover-repro/node_modules/react-useportal/package.json","includedInParent":true,"mtime":1606848740637},{"name":"react","loc":{"line":28,"column":22},"parent":"/Users/rheinze/Code/uikitten-popover-repro/node_modules/react-useportal/dist/usePortal.js","resolved":"/Users/rheinze/Code/uikitten-popover-repro/node_modules/react/index.js"},{"name":"react-dom","loc":{"line":29,"column":26},"parent":"/Users/rheinze/Code/uikitten-popover-repro/node_modules/react-useportal/dist/usePortal.js","resolved":"/Users/rheinze/Code/uikitten-popover-repro/node_modules/react-dom/index.js"},{"name":"use-ssr","loc":{"line":30,"column":40},"parent":"/Users/rheinze/Code/uikitten-popover-repro/node_modules/react-useportal/dist/usePortal.js","resolved":"/Users/rheinze/Code/uikitten-popover-repro/node_modules/use-ssr/dist/useSSR.js"}],"generated":{"js":"\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar react_1 = require(\"react\");\nvar react_dom_1 = require(\"react-dom\");\nvar use_ssr_1 = __importDefault(require(\"use-ssr\"));\nexports.errorMessage1 = 'You must either add a `ref` to the element you are interacting with or pass an `event` to openPortal(e) or togglePortal(e).';\nfunction usePortal(_a) {\n    if (_a === void 0) { _a = {}; }\n    var _b = _a.closeOnOutsideClick, closeOnOutsideClick = _b === void 0 ? true : _b, _c = _a.closeOnEsc, closeOnEsc = _c === void 0 ? true : _c, bindTo = _a.bindTo, // attach the portal to this node in the DOM\n    _d = _a.isOpen, // attach the portal to this node in the DOM\n    defaultIsOpen = _d === void 0 ? false : _d, onOpen = _a.onOpen, onClose = _a.onClose, onPortalClick = _a.onPortalClick, eventHandlers = __rest(_a, [\"closeOnOutsideClick\", \"closeOnEsc\", \"bindTo\", \"isOpen\", \"onOpen\", \"onClose\", \"onPortalClick\"]);\n    var _e = use_ssr_1.default(), isServer = _e.isServer, isBrowser = _e.isBrowser;\n    var _f = react_1.useState(defaultIsOpen), isOpen = _f[0], makeOpen = _f[1];\n    // we use this ref because `isOpen` is stale for handleOutsideMouseClick\n    var open = react_1.useRef(isOpen);\n    var setOpen = react_1.useCallback(function (v) {\n        // workaround to not have stale `isOpen` in the handleOutsideMouseClick\n        open.current = v;\n        makeOpen(v);\n    }, []);\n    var targetEl = react_1.useRef(); // this is the element you are clicking/hovering/whatever, to trigger opening the portal\n    var portal = react_1.useRef(isBrowser ? document.createElement('div') : null);\n    react_1.useEffect(function () {\n        if (isBrowser && !portal.current)\n            portal.current = document.createElement('div');\n    }, [isBrowser, portal]);\n    var elToMountTo = react_1.useMemo(function () {\n        if (isServer)\n            return;\n        return (bindTo && react_dom_1.findDOMNode(bindTo)) || document.body;\n    }, [isServer, bindTo]);\n    var createCustomEvent = function (e) {\n        if (!e)\n            return { portal: portal, targetEl: targetEl, event: e };\n        var event = e || {};\n        if (event.persist)\n            event.persist();\n        event.portal = portal;\n        event.targetEl = targetEl;\n        event.event = e;\n        var currentTarget = e.currentTarget;\n        if (!targetEl.current && currentTarget && currentTarget !== document)\n            targetEl.current = event.currentTarget;\n        return event;\n    };\n    // this should handle all eventHandlers like onClick, onMouseOver, etc. passed into the config\n    var customEventHandlers = Object\n        .entries(eventHandlers)\n        .reduce(function (acc, _a) {\n        var handlerName = _a[0], eventHandler = _a[1];\n        acc[handlerName] = function (event) {\n            if (isServer)\n                return;\n            eventHandler(createCustomEvent(event));\n        };\n        return acc;\n    }, {});\n    var openPortal = react_1.useCallback(function (e) {\n        if (isServer)\n            return;\n        var customEvent = createCustomEvent(e);\n        // for some reason, when we don't have the event argument, there\n        // is a weird race condition. Would like to see if we can remove\n        // setTimeout, but for now this works\n        if (targetEl.current == null) {\n            setTimeout(function () { return setOpen(true); }, 0);\n            throw Error(exports.errorMessage1);\n        }\n        if (onOpen)\n            onOpen(customEvent);\n        setOpen(true);\n    }, [isServer, portal, setOpen, targetEl, onOpen]);\n    var closePortal = react_1.useCallback(function (e) {\n        if (isServer)\n            return;\n        var customEvent = createCustomEvent(e);\n        if (onClose && open.current)\n            onClose(customEvent);\n        if (open.current)\n            setOpen(false);\n    }, [isServer, onClose, setOpen]);\n    var togglePortal = react_1.useCallback(function (e) {\n        return open.current ? closePortal(e) : openPortal(e);\n    }, [closePortal, openPortal]);\n    var handleKeydown = react_1.useCallback(function (e) {\n        return (e.key === 'Escape' && closeOnEsc) ? closePortal(e) : undefined;\n    }, [closeOnEsc, closePortal]);\n    var handleOutsideMouseClick = react_1.useCallback(function (e) {\n        var containsTarget = function (target) { return target.current.contains(e.target); };\n        if (containsTarget(portal) || e.button !== 0 || !open.current || containsTarget(targetEl))\n            return;\n        if (closeOnOutsideClick)\n            closePortal(e);\n    }, [isServer, closePortal, closeOnOutsideClick, portal]);\n    var handleMouseDown = react_1.useCallback(function (e) {\n        if (isServer || !(portal.current instanceof HTMLElement))\n            return;\n        var customEvent = createCustomEvent(e);\n        if (portal.current.contains(customEvent.target) && onPortalClick)\n            onPortalClick(customEvent);\n        handleOutsideMouseClick(e);\n    }, [handleOutsideMouseClick]);\n    // used to remove the event listeners on unmount\n    var eventListeners = react_1.useRef({});\n    react_1.useEffect(function () {\n        if (isServer)\n            return;\n        if (!(elToMountTo instanceof HTMLElement) || !(portal.current instanceof HTMLElement))\n            return;\n        // TODO: eventually will need to figure out a better solution for this.\n        // Surely we can find a way to map onScroll/onWheel -> scroll/wheel better,\n        // but for all other event handlers. For now this works.\n        var eventHandlerMap = {\n            onScroll: 'scroll',\n            onWheel: 'wheel',\n        };\n        var node = portal.current;\n        elToMountTo.appendChild(portal.current);\n        // handles all special case handlers. Currently only onScroll and onWheel\n        Object.entries(eventHandlerMap).forEach(function (_a) {\n            var handlerName = _a[0] /* onScroll */, eventListenerName = _a[1] /* scroll */;\n            if (!eventHandlers[handlerName])\n                return;\n            eventListeners.current[handlerName] = function (e) { return eventHandlers[handlerName](createCustomEvent(e)); };\n            document.addEventListener(eventListenerName, eventListeners.current[handlerName]);\n        });\n        document.addEventListener('keydown', handleKeydown);\n        document.addEventListener('mousedown', handleMouseDown);\n        return function () {\n            // handles all special case handlers. Currently only onScroll and onWheel\n            Object.entries(eventHandlerMap).forEach(function (_a) {\n                var handlerName = _a[0], eventListenerName = _a[1];\n                if (!eventHandlers[handlerName])\n                    return;\n                document.removeEventListener(eventListenerName, eventListeners.current[handlerName]);\n                delete eventListeners.current[handlerName];\n            });\n            document.removeEventListener('keydown', handleKeydown);\n            document.removeEventListener('mousedown', handleMouseDown);\n            elToMountTo.removeChild(node);\n        };\n    }, [isServer, handleOutsideMouseClick, handleKeydown, elToMountTo, portal]);\n    var Portal = react_1.useCallback(function (_a) {\n        var children = _a.children;\n        if (portal.current != null)\n            return react_dom_1.createPortal(children, portal.current);\n        return null;\n    }, [portal]);\n    return Object.assign([openPortal, closePortal, open.current, Portal, togglePortal, targetEl, portal], __assign(__assign({ isOpen: open.current, openPortal: openPortal, ref: targetEl, closePortal: closePortal,\n        togglePortal: togglePortal,\n        Portal: Portal, portalRef: portal }, customEventHandlers), { bind: __assign({ ref: targetEl }, customEventHandlers) }));\n}\nexports.default = usePortal;\n"},"sourceMaps":{"js":{"version":3,"file":"usePortal.js","sourceRoot":"","sources":["../usePortal.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,+BAAiJ;AACjJ,uCAAqD;AACrD,oDAA4B;AAgCf,QAAA,aAAa,GAAG,6HAA6H,CAAA;AAE1J,SAAwB,SAAS,CAAC,EASV;IATU,mBAAA,EAAA,OASV;IARtB,IAAA,2BAA0B,EAA1B,+CAA0B,EAC1B,kBAAiB,EAAjB,sCAAiB,EACjB,kBAAM,EAAE,4CAA4C;IACpD,cAA6B,EADrB,4CAA4C;IACpD,0CAA6B,EAC7B,kBAAM,EACN,oBAAO,EACP,gCAAa,EACb,2HAAgB;IAEV,IAAA,wBAAkC,EAAhC,sBAAQ,EAAE,wBAAsB,CAAA;IAClC,IAAA,oCAA4C,EAA3C,cAAM,EAAE,gBAAmC,CAAA;IAClD,wEAAwE;IACxE,IAAM,IAAI,GAAG,cAAM,CAAC,MAAM,CAAC,CAAA;IAE3B,IAAM,OAAO,GAAG,mBAAW,CAAC,UAAC,CAAU;QACrC,uEAAuE;QACvE,IAAI,CAAC,OAAO,GAAG,CAAC,CAAA;QAChB,QAAQ,CAAC,CAAC,CAAC,CAAA;IACb,CAAC,EAAE,EAAE,CAAC,CAAA;IAEN,IAAM,QAAQ,GAAG,cAAM,EAAe,CAAA,CAAC,wFAAwF;IAC/H,IAAM,MAAM,GAAG,cAAM,CAAC,SAAS,CAAC,CAAC,CAAC,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAc,CAAA;IAEpF,iBAAS,CAAC;QACR,IAAI,SAAS,IAAI,CAAC,MAAM,CAAC,OAAO;YAAE,MAAM,CAAC,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAA;IAClF,CAAC,EAAE,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC,CAAA;IAEvB,IAAM,WAAW,GAAG,eAAO,CAAC;QAC1B,IAAI,QAAQ;YAAE,OAAM;QACpB,OAAO,CAAC,MAAM,IAAI,uBAAW,CAAC,MAAM,CAAC,CAAC,IAAI,QAAQ,CAAC,IAAI,CAAA;IACzD,CAAC,EAAE,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC,CAAA;IAEtB,IAAM,iBAAiB,GAAG,UAAC,CAAM;QAC/B,IAAI,CAAC,CAAC;YAAE,OAAO,EAAE,MAAM,QAAA,EAAE,QAAQ,UAAA,EAAE,KAAK,EAAE,CAAC,EAAE,CAAA;QAC7C,IAAM,KAAK,GAAG,CAAC,IAAI,EAAE,CAAA;QACrB,IAAI,KAAK,CAAC,OAAO;YAAE,KAAK,CAAC,OAAO,EAAE,CAAA;QAClC,KAAK,CAAC,MAAM,GAAG,MAAM,CAAA;QACrB,KAAK,CAAC,QAAQ,GAAG,QAAQ,CAAA;QACzB,KAAK,CAAC,KAAK,GAAG,CAAC,CAAA;QACP,IAAA,+BAAa,CAAM;QAC3B,IAAI,CAAC,QAAQ,CAAC,OAAO,IAAI,aAAa,IAAI,aAAa,KAAK,QAAQ;YAAE,QAAQ,CAAC,OAAO,GAAG,KAAK,CAAC,aAAa,CAAA;QAC5G,OAAO,KAAK,CAAA;IACd,CAAC,CAAA;IAED,8FAA8F;IAC9F,IAAM,mBAAmB,GAAwB,MAAM;SACpD,OAAO,CAAC,aAAa,CAAC;SACtB,MAAM,CAAM,UAAC,GAAG,EAAE,EAA2B;YAA1B,mBAAW,EAAE,oBAAY;QAC3C,GAAG,CAAC,WAAW,CAAC,GAAG,UAAC,KAAkC;YACpD,IAAI,QAAQ;gBAAE,OAAM;YACpB,YAAY,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC,CAAA;QACxC,CAAC,CAAA;QACD,OAAO,GAAG,CAAA;IACZ,CAAC,EAAE,EAAE,CAAC,CAAA;IAER,IAAM,UAAU,GAAG,mBAAW,CAAC,UAAC,CAAM;QACpC,IAAI,QAAQ;YAAE,OAAM;QACpB,IAAM,WAAW,GAAG,iBAAiB,CAAC,CAAC,CAAC,CAAA;QACxC,gEAAgE;QAChE,gEAAgE;QAChE,qCAAqC;QACrC,IAAI,QAAQ,CAAC,OAAO,IAAI,IAAI,EAAE;YAC5B,UAAU,CAAC,cAAM,OAAA,OAAO,CAAC,IAAI,CAAC,EAAb,CAAa,EAAE,CAAC,CAAC,CAAA;YAClC,MAAM,KAAK,CAAC,qBAAa,CAAC,CAAA;SAC3B;QACD,IAAI,MAAM;YAAE,MAAM,CAAC,WAAW,CAAC,CAAA;QAC/B,OAAO,CAAC,IAAI,CAAC,CAAA;IACf,CAAC,EAAE,CAAC,QAAQ,EAAE,MAAM,EAAE,OAAO,EAAE,QAAQ,EAAE,MAAM,CAAC,CAAC,CAAA;IAEjD,IAAM,WAAW,GAAG,mBAAW,CAAC,UAAC,CAAM;QACrC,IAAI,QAAQ;YAAE,OAAM;QACpB,IAAM,WAAW,GAAG,iBAAiB,CAAC,CAAC,CAAC,CAAA;QACxC,IAAI,OAAO,IAAI,IAAI,CAAC,OAAO;YAAE,OAAO,CAAC,WAAW,CAAC,CAAA;QACjD,IAAI,IAAI,CAAC,OAAO;YAAE,OAAO,CAAC,KAAK,CAAC,CAAA;IAClC,CAAC,EAAE,CAAC,QAAQ,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC,CAAA;IAEhC,IAAM,YAAY,GAAG,mBAAW,CAAC,UAAC,CAA6B;QAC7D,OAAA,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC;IAA7C,CAA6C,EAC7C,CAAC,WAAW,EAAE,UAAU,CAAC,CAC1B,CAAA;IAED,IAAM,aAAa,GAAG,mBAAW,CAAC,UAAC,CAAgB;QACjD,OAAA,CAAC,CAAC,CAAC,GAAG,KAAK,QAAQ,IAAI,UAAU,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS;IAA/D,CAA+D,EAC/D,CAAC,UAAU,EAAE,WAAW,CAAC,CAC1B,CAAA;IAED,IAAM,uBAAuB,GAAG,mBAAW,CAAC,UAAC,CAAa;QACxD,IAAM,cAAc,GAAG,UAAC,MAAiB,IAAK,OAAA,MAAM,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,CAAC,MAAqB,CAAC,EAAhD,CAAgD,CAAA;QAC9F,IAAI,cAAc,CAAC,MAAM,CAAC,IAAK,CAAS,CAAC,MAAM,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,IAAI,cAAc,CAAC,QAAQ,CAAC;YAAE,OAAM;QAC1G,IAAI,mBAAmB;YAAE,WAAW,CAAC,CAAC,CAAC,CAAA;IACzC,CAAC,EAAE,CAAC,QAAQ,EAAE,WAAW,EAAE,mBAAmB,EAAE,MAAM,CAAC,CAAC,CAAA;IAExD,IAAM,eAAe,GAAG,mBAAW,CAAC,UAAC,CAAa;QAChD,IAAI,QAAQ,IAAI,CAAC,CAAC,MAAM,CAAC,OAAO,YAAY,WAAW,CAAC;YAAE,OAAM;QAChE,IAAM,WAAW,GAAG,iBAAiB,CAAC,CAAC,CAAC,CAAA;QACxC,IAAI,MAAM,CAAC,OAAO,CAAC,QAAQ,CAAC,WAAW,CAAC,MAAqB,CAAC,IAAI,aAAa;YAAE,aAAa,CAAC,WAAW,CAAC,CAAA;QAC3G,uBAAuB,CAAC,CAAC,CAAC,CAAA;IAC5B,CAAC,EAAE,CAAC,uBAAuB,CAAC,CAAC,CAAA;IAE7B,gDAAgD;IAChD,IAAM,cAAc,GAAG,cAAM,CAAC,EAAE,CAAsB,CAAA;IAEtD,iBAAS,CAAC;QACR,IAAI,QAAQ;YAAE,OAAM;QACpB,IAAI,CAAC,CAAC,WAAW,YAAY,WAAW,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC,OAAO,YAAY,WAAW,CAAC;YAAE,OAAM;QAE7F,uEAAuE;QACvE,2EAA2E;QAC3E,wDAAwD;QACxD,IAAM,eAAe,GAAqB;YACxC,QAAQ,EAAE,QAAQ;YAClB,OAAO,EAAE,OAAO;SACjB,CAAA;QACD,IAAM,IAAI,GAAG,MAAM,CAAC,OAAO,CAAA;QAC3B,WAAW,CAAC,WAAW,CAAC,MAAM,CAAC,OAAO,CAAC,CAAA;QACvC,yEAAyE;QACzE,MAAM,CAAC,OAAO,CAAC,eAAe,CAAC,CAAC,OAAO,CAAC,UAAC,EAA4D;gBAA3D,mBAAW,CAAC,cAAc,EAAE,yBAAiB,CAAC,YAAY;YAClG,IAAI,CAAC,aAAa,CAAC,WAAqC,CAAC;gBAAE,OAAM;YACjE,cAAc,CAAC,OAAO,CAAC,WAAqC,CAAC,GAAG,UAAC,CAAM,IAAK,OAAC,aAAa,CAAC,WAAqC,CAAS,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC,EAAnF,CAAmF,CAAA;YAC/J,QAAQ,CAAC,gBAAgB,CAAC,iBAAsD,EAAE,cAAc,CAAC,OAAO,CAAC,WAAqC,CAAQ,CAAC,CAAA;QACzJ,CAAC,CAAC,CAAA;QACF,QAAQ,CAAC,gBAAgB,CAAC,SAAS,EAAE,aAAa,CAAC,CAAA;QACnD,QAAQ,CAAC,gBAAgB,CAAC,WAAW,EAAE,eAAsB,CAAC,CAAA;QAE9D,OAAO;YACL,yEAAyE;YACzE,MAAM,CAAC,OAAO,CAAC,eAAe,CAAC,CAAC,OAAO,CAAC,UAAC,EAAgC;oBAA/B,mBAAW,EAAE,yBAAiB;gBACtE,IAAI,CAAC,aAAa,CAAC,WAAqC,CAAC;oBAAE,OAAM;gBACjE,QAAQ,CAAC,mBAAmB,CAAC,iBAAsD,EAAE,cAAc,CAAC,OAAO,CAAC,WAAqC,CAAQ,CAAC,CAAA;gBAC1J,OAAO,cAAc,CAAC,OAAO,CAAC,WAAqC,CAAC,CAAA;YACtE,CAAC,CAAC,CAAA;YACF,QAAQ,CAAC,mBAAmB,CAAC,SAAS,EAAE,aAAa,CAAC,CAAA;YACtD,QAAQ,CAAC,mBAAmB,CAAC,WAAW,EAAE,eAAsB,CAAC,CAAA;YACjE,WAAW,CAAC,WAAW,CAAC,IAAI,CAAC,CAAA;QAC/B,CAAC,CAAA;IACH,CAAC,EAAE,CAAC,QAAQ,EAAE,uBAAuB,EAAE,aAAa,EAAE,WAAW,EAAE,MAAM,CAAC,CAAC,CAAA;IAE3E,IAAM,MAAM,GAAG,mBAAW,CAAC,UAAC,EAAqC;YAAnC,sBAAQ;QACpC,IAAI,MAAM,CAAC,OAAO,IAAI,IAAI;YAAE,OAAO,wBAAY,CAAC,QAAQ,EAAE,MAAM,CAAC,OAAO,CAAC,CAAA;QACzE,OAAO,IAAI,CAAA;IACb,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,CAAA;IAEZ,OAAO,MAAM,CAAC,MAAM,CAClB,CAAC,UAAU,EAAE,WAAW,EAAE,IAAI,CAAC,OAAO,EAAE,MAAM,EAAE,YAAY,EAAE,QAAQ,EAAE,MAAM,CAAC,sBAE7E,MAAM,EAAE,IAAI,CAAC,OAAO,EACpB,UAAU,YAAA,EACV,GAAG,EAAE,QAAQ,EACb,WAAW,aAAA;QACX,YAAY,cAAA;QACZ,MAAM,QAAA,EACN,SAAS,EAAE,MAAM,IACd,mBAAmB,KACtB,IAAI,aACF,GAAG,EAAE,QAAQ,IACV,mBAAmB,KAG3B,CAAA;AACH,CAAC;AAhKD,4BAgKC","sourcesContent":[null]}},"error":null,"hash":"8f01e54adad701b4a9bd536b773aa66f","cacheData":{"env":{}}}